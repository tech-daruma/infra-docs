<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>InfraStructure Documentation</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="The example book covers examples.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> Documentation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="aks/index.html"><strong aria-hidden="true">1.1.</strong> AKS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="aks/cluster-design/AKS-CLUSTER-DESIGN.html"><strong aria-hidden="true">1.1.1.</strong> Cluster Design</a></li><li class="chapter-item expanded "><a href="aks/tasks.html"><strong aria-hidden="true">1.1.2.</strong> Upcoming Ops Tasks</a></li><li class="spacer"></li></ol></li></ol></li><li class="chapter-item expanded "><a href="misc/contributors.html">Contributors</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">InfraStructure Documentation</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#documentation" id="documentation">Documentation</a></h1>
<h1><a class="header" href="#jetblue---aks-knowledge-transfer" id="jetblue---aks-knowledge-transfer">jetBlue - AKS knowledge transfer</a></h1>
<h2><a class="header" href="#aks-cluster-design-review-and-deployment-process" id="aks-cluster-design-review-and-deployment-process">AKS Cluster design review and deployment process</a></h2>
<ul>
<li>Network design, placement, FW requirements</li>
<li>Node Pool machine types, skus, app placement, labels, taints &amp;   * rations, node pools for new breaking changes.</li>
<li>Monitoring evidence for VM SKU optimization to right size nodepools</li>
<li>RBAC – Kubernetes and </li>
<li>Roles and responsibilities (IT infra, ITPE, EA, DevOps and Developers)</li>
<li>Troubleshooting 101</li>
<li>Upcoming updates from Microsoft and recommended actions.</li>
</ul>
<h2><a class="header" href="#terraform-scripting-and-code-deployment" id="terraform-scripting-and-code-deployment">Terraform scripting and code deployment</a></h2>
<h2><a class="header" href="#kubernetes-ingres-nginx-controller-deployment-and-maintenance" id="kubernetes-ingres-nginx-controller-deployment-and-maintenance">Kubernetes Ingres (Nginx controller) deployment and maintenance</a></h2>
<h2><a class="header" href="#understanding-k8s-load-balancing-design-and-integration-with-azure-load-balancers-f5" id="understanding-k8s-load-balancing-design-and-integration-with-azure-load-balancers-f5">Understanding K8s load balancing design, and integration with Azure load balancers, F5</a></h2>
<h2><a class="header" href="#security-monitoring-and-remediation" id="security-monitoring-and-remediation">Security monitoring and remediation</a></h2>
<h2><a class="header" href="#workers-to-control-plane-workers-to-external-services-ms-and-applications-salt-minions-twistlock-bitbucket" id="workers-to-control-plane-workers-to-external-services-ms-and-applications-salt-minions-twistlock-bitbucket">Workers to control plane, Workers to external services (MS and applications), Salt minions, TwistLock, BitBucket</a></h2>
<h2><a class="header" href="#aks-upgrades-and-redeployment-process" id="aks-upgrades-and-redeployment-process">AKS upgrades and redeployment process</a></h2>
<h2><a class="header" href="#flux-configuration-management-for-aks" id="flux-configuration-management-for-aks">Flux configuration management for AKS</a></h2>
<h2><a class="header" href="#aks-performance-monitoring-and-management" id="aks-performance-monitoring-and-management">AKS performance monitoring and management</a></h2>
<h2><a class="header" href="#aks-roles-and-responsibilities-and-best-practices" id="aks-roles-and-responsibilities-and-best-practices">AKS Roles and responsibilities and best practices</a></h2>
<h2><a class="header" href="#methods-for-developers-to-debug-their-applications-kubectl-dashboards-log-analytics-sumo-logic" id="methods-for-developers-to-debug-their-applications-kubectl-dashboards-log-analytics-sumo-logic">Methods for developers to debug their applications. (Kubectl, dashboards, log analytics, sumo logic)</a></h2>
<h2><a class="header" href="#pain-points-areas-for-improvement-tasks-that-could-be-further-automated" id="pain-points-areas-for-improvement-tasks-that-could-be-further-automated">Pain points, areas for improvement, tasks that could be further automated.</a></h2>
<h2><a class="header" href="#in-addition-to-above-documentation-and-kt-to-infra-architecture--automation-to-include-deep-dive-on-date-tbd" id="in-addition-to-above-documentation-and-kt-to-infra-architecture--automation-to-include-deep-dive-on-date-tbd">In addition to above, Documentation and KT to Infra Architecture &amp; Automation to include deep dive on [Date TBD]:</a></h2>
<ol>
<li>
<p>AKS Design patterns including Azure Zone HA and Geographic DR design (including trafic management)</p>
</li>
<li>
<p>AKS road-map and version update considerations</p>
</li>
<li>
<p>K8s Service Mesh options (istio, kong, etc.) and recommendations</p>
</li>
<li>
<p>Terraform scripting.</p>
<ul>
<li>How to create and maintain code for AKS</li>
<li>How to create and maintain code for AKS</li>
<li>How to inspect, interpret and debug Terraform scripts</li>
<li>How to run Terraform plans, inspect output, troubleshoot and adjust de</li>
<li>Twistlock integration design, touchpoints</li>
</ul>
</li>
<li>
<p>Flux deep-dive with design and code review</p>
</li>
<li>
<p>Persistent storage driver/AFS and best practices.</p>
</li>
<li>
<p>AKS budgeting and cost reporting tool (CloudIQ utility)</p>
<ul>
<li>Design review, requirements</li>
<li>Deployment process</li>
<li>How to configure, monitor, alert on spend, etc.</li>
</ul>
</li>
</ol>
<h1><a class="header" href="#aks-cluster-design-review-and-deployment-process-1" id="aks-cluster-design-review-and-deployment-process-1">AKS Cluster Design review and deployment process</a></h1>
<ul>
<li>Network design, placement, FW requirements</li>
</ul>
<pre><code class="language-sh">az aks show -g $RG -n $AKS --query networkProfile
</code></pre>
<ul>
<li>Node Pool machine types, skus, app placement, labels, taints &amp;   * rations, node pools for new breaking changes.</li>
<li>Monitoring evidence for VM SKU optimization to right size nodepools</li>
<li>RBAC – Kubernetes and </li>
<li>Roles and responsibilities (IT infra, ITPE, EA, DevOps and Developers)</li>
<li>Troubleshooting 101</li>
<li>Upcoming updates from Microsoft and recommended actions. </li>
</ul>
<h1><a class="header" href="#aks-important-maintanence-tasks" id="aks-important-maintanence-tasks">AKS important maintanence tasks</a></h1>
<hr />
<p><strong>NOTE</strong></p>
<p>These are upcoming infra tasks to improve general stability and performance of AKS. These include, but are not limited to:</p>
<ul>
<li>Ephemeral OS disks</li>
<li>Podidentity upgrade to (NMI) only mode and v1.7.1 +.</li>
<li>Control Plane and Node Pool upgrades to 1.18.x</li>
<li>Node Image upgrades &amp; Automating node images (full vs semi)</li>
<li>Thread of DISK I/O issues on AKS in general given <a href="https://github.com/Azure/AKS/issues/1373">here</a></li>
</ul>
<hr />
<h2><a class="header" href="#ephemeral-os-disks" id="ephemeral-os-disks">Ephemeral OS disks</a></h2>
<p>This resolves many Disk I/O issues for container hosts in general.</p>
<hr />
<p><strong>IMPORTANT</strong></p>
<p>With ephemeral OS you can deploy VM and instance images up to the size of the VM cache. In the AKS case, the default node OS disk configuration uses 128GB, which means that you need a VM size that has a cache larger than 128GB. The default Standard_DS2_v2 has a cache size of 86GB, which is not large enough. The Standard_DS3_v2 has a cache size of 172GB, which is large enough. You can also reduce the default size of the OS disk by using --node-osdisk-size. The minimum size for AKS images is 30GB.</p>
<hr />
<ol>
<li>General doc on using Ephemeral OS Disk with AKS in general is given <a href="https://docs.microsoft.com/en-us/azure/aks/cluster-configuration#ephemeral-os">here</a></li>
<li></li>
</ol>
<h1><a class="header" href="#contributors" id="contributors">Contributors</a></h1>
<p>Here is a list of the contributors who have helped improving Documentation. Big
shout-out to them!</p>
<ul>
<li>Subramani Ananthapadmanabhan (<a href="https://github.com/asubmani">asubmani</a>)</li>
</ul>
<p>If you feel you're missing from this list, feel free to add yourself in a PR.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>
        
        

    </body>
</html>
